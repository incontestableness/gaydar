<!DOCTYPE html>
<html>
	<head>
		<title>Gaydar Controller</title>
		<style>
			body {
				background-color: black;
				color: white;
			}
		</style>
		<script>
			fetch("/gaydar/get_scenes")
				.then(response => response.json())
				.then(json => {
					var scene_names = json["scenes"];
					var selector = document.getElementById("scene_selector");
					for (var i = 0; i < scene_names.length; i++) {
						console.log(i);
						var option = document.createElement("option");
						option.text = scene_names[i];
						selector.add(option);
					}
				}
			);
		</script>
	</head>

	<body>
		<h1>Gaydar Controller</h1>
		<form action="/gaydar/set_color">
			<input type="color" name="color" value="#ff0000" onchange="document.getElementById('save_color').value = this.value;">
			<input type="submit" value="Set Color">
		</form>
		<form action="/gaydar/set_color_temperature">
			<!-- Default to ~5800K -->
			<!-- TODO: Use fetch() instead of forms for iOS compatibility? -->
			<!-- TODO: Verify color_temperature range manually -->
			<!-- TODO: gaydar.py only needs to call scene_store instead of scene_add; but, we would like a numerical ticker to change values (sync that instead) -->
			<input type="hidden" id="color_temperature" name="color_temperature" value="172">
			<input type="range" id="color_temperature_slider" min="150" max="500" value="172"
				onchange="document.getElementById('color_temperature_field').value = this.value;
					document.getElementById('color_temperature').value = this.value;
					this.parentElement.submit();">
			<input type="number" id="color_temperature_field" min="150" max="500" value="172"
				onchange="document.getElementById('color_temperature_slider').value = this.value;
					document.getElementById('color_temperature').value = this.value;
					this.parentElement.submit();">
			<input type="submit" value="Set Color Temperature">
		</form>
		<form action="/gaydar/set_brightness">
			<input type="range" name="brightness" min="0" max="254" value="254"
				onchange="document.getElementById('save_brightness').value = this.value;
				this.parentElement.submit();">
			<input type="submit" value="Set Brightness">
		</form>
		<form action="/gaydar/toggle_lights">
			<input type="submit" value="Toggle Lights">
		</form>
		<form action="/gaydar/load_scene">
			<select id="scene_selector" name="scene_name"></select>
			<input type="submit" value="Load Scene">
		</form>
		<form action="/gaydar/save_scene">
			<input type="text" name="scene_name">
			<input id="save_color" type="hidden" name="color" value="#ffffff">
			<input id="save_brightness" type="hidden" name="brightness" value=254>
			<input type="submit" value="Save Scene">
		</form>
		<form action="/gaydar/set_target_names">
			<input type="text" name="targets" value="all">
			<input type="submit" value="Set Targets">
		</form>
	</body>
</html>
